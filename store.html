<!DOCTYPE html>
<html lang="en">
  <script src="https://cdn.jsdelivr.net/npm/tabletop@1.6.1/tabletop.min.js"></script>
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Store - Your Local Card Shop</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen,
        Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
      background: #f7f2ea;
      margin: 0;
      padding: 1rem;
      color: #3a2e1f;
    }
    h1 {
      text-align: center;
    }
    #packRipper {
      margin-top: 2rem;
      text-align: center;
    }
    button {
      font-size: 1.2rem;
      padding: 0.8rem 2rem;
      border-radius: 10px;
      border: none;
      background-color: #6b4c1d;
      color: white;
      cursor: pointer;
      box-shadow: 2px 2px 6px rgba(0,0,0,0.2);
      transition: background-color 0.3s ease;
    }
    button:hover {
      background-color: #4b2e05;
    }
    #card-container {
      margin-top: 2rem;
      display: none;
      flex-direction: column;
      align-items: center;
    }
    #card-container img {
      width: 220px;
      height: 300px;
      object-fit: contain;
      box-shadow: 0 4px 8px rgba(0,0,0,0.15);
      border-radius: 12px;
      margin-bottom: 1rem;
    }
    #card-name {
      font-weight: bold;
      margin-bottom: 1rem;
    }
  </style>
</head>
<body>
  <h1>Your Local Card Shop - Baseball Packs</h1>

  <div id="packRipper">
    <button id="ripPackBtn">Rip a 5-Card Pack</button>
  </div>
<div id="card-container" style="display:none; flex-direction:column; align-items:center; margin-top:2rem;">
  <img id="card-image" src="" alt="Card image" style="width:220px; height:300px; object-fit:contain; border-radius:12px; box-shadow:0 4px 8px rgba(0,0,0,0.15);" />
  <p id="card-name" style="font-weight:bold;"></p>
  <p id="card-type"></p>
  <p id="card-value"></p>
  <button onclick="prevCard()">Previous</button>
  <button onclick="nextCard()">Next</button>
</div>

  </div>
    <script>
  let allCards = [];
  let pack = [];
  let currentIndex = 0;

  function renderCard() {
    const card = pack[currentIndex];
    document.getElementById('card-image').src = card['Image URL'];
    document.getElementById('card-name').innerText = `${card.Player} (#${card['Card Number']})`;
    document.getElementById('card-type').innerText = `Type: ${card.Type}`;
    document.getElementById('card-value').innerText = `Est. Value: $${card.Value}`;
  }

  function nextCard() {
    if (currentIndex < pack.length - 1) {
      currentIndex++;
      renderCard();
    }
  }

  function prevCard() {
    if (currentIndex > 0) {
      currentIndex--;
      renderCard();
    }
  }

  function ripPack() {
    if (allCards.length === 0) {
      alert("Cards not loaded yet. Please wait a few seconds.");
      return;
    }

    pack = [];

    // Insert odds
    const base = allCards.filter(c => c.Type === "Base");
    const ratedRookies = allCards.filter(c => c.Type === "Rated Rookie");
    const diamondKings = allCards.filter(c => c.Type === "Diamond Kings");
    const mvps = allCards.filter(c => c.Type === "MVP");

    function randomCard(list) {
      return list[Math.floor(Math.random() * list.length)];
    }

    // 1 in 5 chance for Rated Rookie, DK, or MVP
    const odds = Math.random();

    // Base pack
    for (let i = 0; i < 5; i++) {
      if (i === 0 && odds < 0.2 && ratedRookies.length) {
        pack.push(randomCard(ratedRookies));
      } else if (i === 1 && odds < 0.2 && diamondKings.length) {
        pack.push(randomCard(diamondKings));
      } else if (i === 2 && odds < 0.2 && mvps.length) {
        pack.push(randomCard(mvps));
      } else {
        pack.push(randomCard(base));
      }
    }

    currentIndex = 0;
    renderCard();
    document.getElementById('card-container').style.display = 'flex';
  }

  window.onload = function() {
    Tabletop.init({
      key: 'https://docs.google.com/spreadsheets/d/1-ZMcxox4TgVmXYyqjK3wxjt7s0xZi2rmLL1jv3sc8Fs/edit?usp=sharing',
      simpleSheet: true,
      callback: function(data) {
        allCards = data;
        console.log("Loaded cards:", allCards.length);
      }
    });

    document.getElementById('ripPackBtn').addEventListener('click', ripPack);
  };
</script>
</body>
</html>
